<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stuxnet Trading Intelligence üöÄ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #0b0f19; color: #e2e8f0; }
        .glass-card {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }
        .neon-text {
            text-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
        }
        .ticker-move {
            animation: ticker 20s linear infinite;
        }
        @keyframes ticker {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0b0f19; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- Navbar & Marquee -->
    <nav class="fixed top-0 w-full z-50 glass-card border-b border-gray-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 flex items-center justify-center font-bold text-white">S</div>
                    <span class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-400 neon-text">
                        Stuxnet Trade Intel
                    </span>
                </div>
                <div class="hidden md:flex space-x-8 text-sm font-medium text-gray-400">
                    <a href="#" class="hover:text-white transition">Crypto</a>
                    <a href="#" class="hover:text-white transition">Forex</a>
                    <a href="#" class="hover:text-white transition">Commodities</a>
                    <a href="#" class="hover:text-white transition">AI Analysis</a>
                </div>
                <div class="flex items-center gap-4">
                     <div id="yangon-weather" class="text-xs text-blue-300 bg-blue-900/20 px-3 py-1 rounded-full border border-blue-500/30 flex items-center gap-2">
                        <span>üå¶Ô∏è YGN: Loading...</span>
                    </div>
                    <button class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-semibold transition shadow-lg shadow-blue-500/20">
                        Connect Wallet
                    </button>
                </div>
            </div>
        </div>
        <!-- Live Ticker -->
        <div class="h-8 bg-black/40 flex items-center overflow-hidden border-t border-gray-800">
            <div class="whitespace-nowrap ticker-move text-xs font-mono text-gray-400" id="marquee-ticker">
                BTC: Loading... ‚Ä¢ ETH: Loading... ‚Ä¢ GOLD: $2,650 ‚Ä¢ OIL: $78.20 ‚Ä¢ SOL: Loading...
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto space-y-6">
        
        <!-- Top Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <!-- BTC Card -->
            <div class="glass-card p-5 rounded-2xl hover:scale-[1.02] transition duration-300">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-sm text-gray-400">Bitcoin (BTC)</p>
                        <h3 class="text-2xl font-bold text-white mt-1" id="price-btc">Wait...</h3>
                    </div>
                    <span class="text-green-400 bg-green-900/20 px-2 py-1 rounded text-xs font-mono live-indicator">‚óè Live</span>
                </div>
            </div>
            <!-- ETH Card -->
            <div class="glass-card p-5 rounded-2xl hover:scale-[1.02] transition duration-300">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-sm text-gray-400">Ethereum (ETH)</p>
                        <h3 class="text-2xl font-bold text-white mt-1" id="price-eth">Wait...</h3>
                    </div>
                    <span class="text-green-400 bg-green-900/20 px-2 py-1 rounded text-xs font-mono live-indicator">‚óè Live</span>
                </div>
            </div>
            <!-- Gold Card -->
            <div class="glass-card p-5 rounded-2xl hover:scale-[1.02] transition duration-300">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-sm text-gray-400">Gold (XAU)</p>
                        <h3 class="text-2xl font-bold text-yellow-400 mt-1" id="price-gold">$2,654.20</h3>
                    </div>
                    <span class="text-gray-400 text-xs mt-1">oz</span>
                </div>
                <div class="mt-2 text-xs text-gray-500">Global Spot Market</div>
            </div>
            <!-- Oil Card -->
            <div class="glass-card p-5 rounded-2xl hover:scale-[1.02] transition duration-300">
                <div class="flex justify-between items-start">
                    <div>
                        <p class="text-sm text-gray-400">Crude Oil (WTI)</p>
                        <h3 class="text-2xl font-bold text-orange-400 mt-1" id="price-oil">$78.45</h3>
                    </div>
                    <span class="text-red-400 bg-red-900/20 px-2 py-1 rounded text-xs font-mono">-0.4%</span>
                </div>
                <div class="mt-2 text-xs text-gray-500">Energy Futures</div>
            </div>
        </div>

        <!-- Main Chart & AI Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 h-[600px]">
            <!-- Chart Section (2 cols) -->
            <div class="lg:col-span-2 glass-card rounded-2xl p-1 flex flex-col h-full relative">
                <div class="absolute top-4 left-4 z-10 flex gap-2">
                    <button class="px-3 py-1 bg-blue-600 text-xs rounded hover:bg-blue-500 text-white font-semibold">BTC/USD</button>
                    <span class="px-3 py-1 bg-gray-800 text-xs rounded text-gray-400">1H Candle</span>
                </div>
                <div id="trading-chart" class="w-full h-full rounded-xl overflow-hidden bg-gray-900"></div>
            </div>

            <!-- AI Insights Panel (1 col) -->
            <div class="glass-card rounded-2xl p-6 flex flex-col h-full">
                <div class="flex items-center justify-between mb-4 border-b border-gray-700 pb-2">
                    <h3 class="text-lg font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400">
                        ü§ñ Ko Paing AI Insights
                    </h3>
                    <span class="text-[10px] bg-green-500/20 text-green-400 px-2 py-0.5 rounded-full animate-pulse">LIVE</span>
                </div>
                
                <div class="flex-1 overflow-y-auto space-y-4 pr-2" id="ai-analysis-feed">
                    <div class="animate-pulse space-y-3">
                        <div class="h-2 bg-gray-700 rounded col-span-2"></div>
                        <div class="h-2 bg-gray-700 rounded col-span-1"></div>
                        <div class="h-20 bg-gray-800 rounded-lg"></div>
                        <p class="text-xs text-gray-500 text-center">Connecting to Brain...</p>
                    </div>
                </div>

                <!-- Alert Input -->
                <div class="mt-4 pt-4 border-t border-gray-700">
                    <label class="text-xs text-gray-400 mb-1 block">Set Price Alert (BTC)</label>
                    <div class="flex gap-2">
                        <input type="number" placeholder="$100,000" class="w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm text-white focus:outline-none focus:border-blue-500">
                        <button class="bg-blue-600 hover:bg-blue-500 px-3 rounded text-white text-sm">Set</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Grid (Commodities & Forex) -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="glass-card p-5 rounded-2xl">
                <h4 class="text-gray-400 text-sm mb-3">Forex (Major Pairs)</h4>
                <div class="space-y-3">
                    <div class="flex justify-between text-sm"><span class="text-gray-300">EUR/USD</span> <span class="text-green-400">1.0845 (+0.1%)</span></div>
                    <div class="flex justify-between text-sm"><span class="text-gray-300">GBP/USD</span> <span class="text-red-400">1.2630 (-0.2%)</span></div>
                    <div class="flex justify-between text-sm"><span class="text-gray-300">USD/JPY</span> <span class="text-green-400">151.20 (+0.5%)</span></div>
                </div>
            </div>
            <div class="glass-card p-5 rounded-2xl">
                <h4 class="text-gray-400 text-sm mb-3">Tech Stocks</h4>
                <div class="space-y-3">
                    <div class="flex justify-between text-sm"><span class="text-gray-300">NVDA</span> <span class="text-green-400">$950.40 (+3.2%)</span></div>
                    <div class="flex justify-between text-sm"><span class="text-gray-300">TSLA</span> <span class="text-red-400">$175.20 (-1.5%)</span></div>
                    <div class="flex justify-between text-sm"><span class="text-gray-300">AAPL</span> <span class="text-gray-400">$172.50 (0.0%)</span></div>
                </div>
            </div>
            <div class="glass-card p-5 rounded-2xl bg-gradient-to-br from-blue-900/20 to-purple-900/20">
                <h4 class="text-gray-400 text-sm mb-2">Fear & Greed Index</h4>
                <div class="flex items-center justify-center h-24">
                    <div class="text-center">
                        <span class="text-4xl font-bold text-green-400">79</span>
                        <p class="text-xs text-green-300 mt-1">Extreme Greed</p>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- 1. TradingView Lightweight Chart Setup ---
        // Ensure container exists before creating chart
        const chartContainer = document.getElementById('trading-chart');
        let chart;
        let candleSeries;
        
        try {
            if (window.LightweightCharts) {
                chart = LightweightCharts.createChart(chartContainer, {
                    layout: { background: { type: 'solid', color: '#111827' }, textColor: '#d1d5db' },
                    grid: { vertLines: { color: '#1f2937' }, horzLines: { color: '#1f2937' } },
                    crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
                    rightPriceScale: { borderColor: '#374151' },
                    timeScale: { borderColor: '#374151' },
                });

                candleSeries = chart.addCandlestickSeries({
                    upColor: '#22c55e', downColor: '#ef4444', borderUpColor: '#22c55e', borderDownColor: '#ef4444',
                    wickUpColor: '#22c55e', wickDownColor: '#ef4444',
                });

                // Generate Mock Data for Chart Initialization
                function generateData() {
                    let data = [];
                    let time = Math.floor(Date.now() / 1000) - (100 * 3600); // 100 hours ago
                    let open = 98000;
                    for (let i = 0; i < 100; i++) {
                        let close = open + (Math.random() - 0.5) * 500;
                        let high = Math.max(open, close) + Math.random() * 200;
                        let low = Math.min(open, close) - Math.random() * 200;
                        data.push({ time: time + i * 3600, open, high, low, close });
                        open = close;
                    }
                    return data;
                }
                candleSeries.setData(generateData());
                
                // Handle Window Resize
                window.addEventListener('resize', () => {
                    chart.resize(chartContainer.clientWidth, chartContainer.clientHeight);
                });
            } else {
                chartContainer.innerHTML = "<p class='text-red-500 text-center mt-20'>Chart Library Failed to Load</p>";
            }
        } catch(e) {
            console.error("Chart Error:", e);
        }

        // --- 2. Live Price Updates (Binance WebSocket) ---
        // Using a more robust connection logic
        function connectWebSocket() {
            const ws = new WebSocket('wss://stream.binance.com:9443/ws/btcusdt@trade/ethusdt@trade');
            
            ws.onopen = () => {
                console.log("Binance WS Connected");
                document.getElementById('price-btc').innerText = "Waiting...";
            };

            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                const price = parseFloat(data.p).toFixed(2);
                
                if (data.s === 'BTCUSDT') {
                    const el = document.getElementById('price-btc');
                    if(el) {
                        el.innerText = `$${price}`;
                        el.classList.add('text-white');
                        // Flash effect could be added here
                    }
                    document.title = `$${price} BTC | Stuxnet Intel`;
                    
                    // Update ticker
                    const ticker = document.getElementById('marquee-ticker');
                    if(ticker && ticker.innerText.includes("Loading")) {
                        ticker.innerText = `BTC: $${price} ‚Ä¢ ETH: ... ‚Ä¢ GOLD: $2,654 ‚Ä¢ OIL: $78.45`;
                    }

                } else if (data.s === 'ETHUSDT') {
                    const el = document.getElementById('price-eth');
                    if(el) el.innerText = `$${price}`;
                }
            };

            ws.onerror = (err) => {
                console.error("WS Error:", err);
            };
            
            ws.onclose = () => {
                console.log("WS Closed, reconnecting...");
                setTimeout(connectWebSocket, 5000);
            };
        }
        connectWebSocket();

        // --- 3. Yangon Weather Fetch ---
        async function fetchWeather() {
            try {
                // Using Open-Meteo (Free, No Key)
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=16.8053&longitude=96.1561&current_weather=true');
                if(!res.ok) throw new Error("Weather API failed");
                const data = await res.json();
                const temp = data.current_weather.temperature;
                const weatherCode = data.current_weather.weathercode;
                
                let icon = "üå§Ô∏è";
                if(weatherCode > 50) icon = "üåßÔ∏è";
                if(weatherCode > 80) icon = "‚õàÔ∏è";

                document.getElementById('yangon-weather').innerHTML = `${icon} YGN: ${temp}¬∞C`;
            } catch (e) {
                console.error("Weather error", e);
                document.getElementById('yangon-weather').innerHTML = `üå§Ô∏è YGN: N/A`;
            }
        }
        fetchWeather();

        // --- 4. Load AI Analysis (Robust Fetch) ---
        async function loadAIAnalysis() {
            const feed = document.getElementById('ai-analysis-feed');
            try {
                // Try fetching from the same domain first (relative path) to avoid CORS if possible, or fallback to absolute
                // GitHub Pages sometimes caches aggressively. 
                // We add a timestamp to bust cache.
                const url = `data/ai_analysis.json?t=${Date.now()}`;
                
                const res = await fetch(url);
                if (!res.ok) throw new Error("JSON not found or network error");
                
                const data = await res.json();
                
                feed.innerHTML = `
                    <div class="bg-blue-900/20 border border-blue-500/30 p-3 rounded-lg mb-3 animate-in fade-in duration-500">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-xs font-bold text-blue-300">LATEST SIGNAL</span>
                            <span class="text-[10px] text-gray-400">${new Date(data.timestamp).toLocaleTimeString()}</span>
                        </div>
                        <h4 class="font-bold text-white text-sm mb-1">${data.title}</h4>
                        <p class="text-xs text-gray-300 leading-relaxed">${data.summary}</p>
                    </div>
                    <div class="space-y-2">
                        <div class="text-xs text-gray-400 font-mono">
                            <span class="text-purple-400">Prediction:</span> <span class="text-white font-bold">${data.prediction}</span><br>
                            <span class="text-green-400">Support:</span> ${data.support} ‚Ä¢ 
                            <span class="text-red-400">Resistance:</span> ${data.resistance}
                        </div>
                    </div>
                `;
            } catch (e) {
                console.log("AI Analysis load failed:", e);
                // Only show placeholder if empty
                if (!feed.innerHTML.includes("LATEST SIGNAL")) {
                     feed.innerHTML = `
                        <div class="bg-gray-800/50 p-4 rounded text-center">
                            <p class="text-xs text-gray-400">Waiting for AI Brain Sync...</p>
                            <p class="text-[10px] text-gray-600 mt-1">System is initializing.</p>
                        </div>`;
                }
            }
        }
        
        // Initial load
        loadAIAnalysis();
        // Periodic refresh every 30s
        setInterval(loadAIAnalysis, 30000);

    </script>
</body>
</html>